---
- name: install taps
  homebrew_tap: tap={{ item }} state=present
  with_items:
    - caskroom/cask
    - caskroom/fonts 
    - argon/mas

- name: install brews
  homebrew: name={{ item }} state=present
  ignore_errors: yes
  with_items:
    - git
    - python
    - mas
    - maven
    - node
    - rbenv
    - ruby
    - wget

- name: install Memcached
  homebrew: name=memcached state=present
  notify: restart memcached

- name: install MySQL
  homebrew: name=mysql state=present
  notify: restart mysql

- name: install RabbitMQ
  homebrew: name=rabbitmq state=present
  notify: restart rabbitmq

- name: install Redis
  homebrew: name=redis state=present
  notify: restart redis

- name: get installed apps from app store
  command: mas list
  when: not lookup("env", "CI")
  register: mas_result
  check_mode: no
  changed_when: false

- name: install apps from app store
  command: mas install {{ item }}
  ignore_errors: yes
  when: not mas_result.skipped|default(false) and item|string not in mas_result.stdout
  with_items:
    - 506189836 # Harvest
    - 413965349 # Soulver
    - 889428659 # xScope
    - 803453959 # Slack
    - 603117688 # CCMenu
    - 969418666 # ColorSnapper2
    - 443987910 # 1Password
    - 775737590 # iA Writer
    - 411643860 # DaisyDisk
    - 497799835 # Xcode
    - 546392952 # Prizmo
    - 924726344 # Deliveries
    - 975937182 # Fantastical 2
    - 407963104 # Pixelmator
    - 955848755 # Theine
    - 406056744 # Evernote
    - 512533449 # Slicy
    - 414957465 # Twitterrific
    - 409183694 # Keynote
    - 409201541 # Pages
    - 409203825 # Numbers
    - 904280696 # Things 3
    - 424389933 # Final Cut Pro
    - 434290957 # Motion
    - 409907375 # Apple Remote Desktop

- name: install casks
  homebrew_cask: name={{ item }} state=present
  when: not lookup("env", "CI")
  ignore_errors: yes
  with_items:
    - alfred
    - appzapper
    - arq
    - atom
    - charles
    - dash
    - docker
    - eclipse-jee
    - google-chrome
    - google-backup-and-sync
    - dropbox
    - firefox
    - java
    - kaleidoscope
    - libreoffice
    - little-snitch
    - paparazzi
    - parallels-desktop
    - paw
    - prince
    - qlstephen
    - qlmarkdown
    - qlprettypatch
    - quicklook-json
    - quicklookase
    - sequel-pro
    - sketch
    - skype
    - textmate
    - tower
    - transmit
    - vagrant
    - vlc
    - font-league-gothic
    - font-raleway
    - font-roboto
    - font-roboto-condensed
    - font-roboto-slab

- name: install pip packages
  pip: name={{ item }} state=present
  with_items:
    - ansible
    - mysqlclient
    - python-memcached
    - virtualenv

- name: install npm packages
  npm: name={{ item }} global=yes state=present
  with_items:
    - bower

- name: install gem packages
  gem: name={{ item }} state=present
  with_items:
    - sass
    - bundler
